Rickshaw.namespace("Rickshaw.Series"),Rickshaw.Series=Rickshaw.Class.create(Array,{initialize:function(t,e,i){i=i||{},this.palette=new Rickshaw.Color.Palette(e),this.timeBase="undefined"==typeof i.timeBase?Math.floor((new Date).getTime()/1e3):i.timeBase;var a="undefined"==typeof i.timeInterval?1e3:i.timeInterval;this.setTimeInterval(a),t&&"object"==typeof t&&Array.isArray(t)&&t.forEach(function(t){this.addItem(t)},this)},addItem:function(t){if("undefined"==typeof t.name)throw"addItem() needs a name";t.color=t.color||this.palette.color(t.name),t.data=t.data||[],0===t.data.length&&this.length&&this.getIndex()>0?this[0].data.forEach(function(e){t.data.push({x:e.x,y:0})}):0===t.data.length&&t.data.push({x:this.timeBase-(this.timeInterval||0),y:0}),this.push(t),this.legend&&this.legend.addLine(this.itemByName(t.name))},addData:function(t,e){var i=this.getIndex();Rickshaw.keys(t).forEach(function(t){this.itemByName(t)||this.addItem({name:t})},this),this.forEach(function(a){a.data.push({x:e||(i*this.timeInterval||1)+this.timeBase,y:t[a.name]||0})},this)},getIndex:function(){return this[0]&&this[0].data&&this[0].data.length?this[0].data.length:0},itemByName:function(t){for(var e=0;e<this.length;e++)if(this[e].name==t)return this[e]},setTimeInterval:function(t){this.timeInterval=t/1e3},setTimeBase:function(t){this.timeBase=t},dump:function(){var t={timeBase:this.timeBase,timeInterval:this.timeInterval,items:[]};return this.forEach(function(e){var i={color:e.color,name:e.name,data:[]};e.data.forEach(function(t){i.data.push({x:t.x,y:t.y})}),t.items.push(i)}),t},load:function(t){t.timeInterval&&(this.timeInterval=t.timeInterval),t.timeBase&&(this.timeBase=t.timeBase),t.items&&t.items.forEach(function(t){this.push(t),this.legend&&this.legend.addLine(this.itemByName(t.name))},this)}}),Rickshaw.Series.zeroFill=function(t){Rickshaw.Series.fill(t,0)},Rickshaw.Series.fill=function(t,e){for(var i,a=0,n=t.map(function(t){return t.data});a<Math.max.apply(null,n.map(function(t){return t.length}));)i=Math.min.apply(null,n.filter(function(t){return t[a]}).map(function(t){return t[a].x})),n.forEach(function(t){t[a]&&t[a].x==i||t.splice(a,0,{x:i,y:e})}),a++};